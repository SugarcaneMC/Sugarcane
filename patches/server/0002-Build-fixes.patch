From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: The Arcane Brony <myrainbowdash949@gmail.com>
Date: Fri, 8 Apr 2022 03:49:03 +0200
Subject: [PATCH] Build fixes

fixup! Build fixes

fixup! Build fixes

diff --git a/.gitignore b/.gitignore
index bb338269c9e3bef4c274157c490d8b8f8c589937..324393177de111d5740f094e6f23d48e61bba7cb 100644
--- a/.gitignore
+++ b/.gitignore
@@ -40,7 +40,10 @@ dependency-reduced-pom.xml
 
 /src/main/resources/achievement
 /src/main/resources/lang
+/src/main/resources/branch-info.properties
 
 # vs code
 /.vscode
 /.factorypath
+
+out/
diff --git a/build.gradle.kts b/build.gradle.kts
index 5dc4106efefb5400cf5504b225e1e6e5788d14f3..34fdd32cb8575d01c2a96d3e2231b603f87e1028 100644
--- a/build.gradle.kts
+++ b/build.gradle.kts
@@ -18,7 +18,7 @@ repositories {
 }
 
 dependencies {
-    implementation(project(":purpur-api")) // Pufferfish // Paper // Purpur
+    implementation(project(":Sugarcane-API")) // Pufferfish // Paper // Purpur // Sugarcane
     // Pufferfish start
     implementation("io.papermc.paper:paper-mojangapi:1.18.2-R0.1-SNAPSHOT") {
         exclude("io.papermc.paper", "paper-api")
@@ -68,6 +68,9 @@ dependencies {
     testImplementation("io.github.classgraph:classgraph:4.8.47") // Paper - mob goal test
     testImplementation("junit:junit:4.13.2")
     testImplementation("org.hamcrest:hamcrest-library:1.3")
+    implementation("org.reflections:reflections:0.10.2") // Sugarcane
+    implementation("org.apache.commons:commons-rng-core:1.3") // Sugarcane - Utilities
+    compileOnly("com.mojang:authlib:2.3.31") // Sugarcane
 }
 
 // Pufferfish Start
@@ -89,7 +92,7 @@ tasks.jar {
         attributes(
             "Main-Class" to "org.bukkit.craftbukkit.Main",
             "Implementation-Title" to "CraftBukkit",
-            "Implementation-Version" to "git-Purpur-$implementationVersion", // Pufferfish // Purpur
+            "Implementation-Version" to "git-Sugarcane-$gitBranch-$implementationVersion", // Pufferfish // Purpur // Sugarcane
             "Implementation-Vendor" to date, // Paper
             "Specification-Title" to "Bukkit",
             "Specification-Version" to project.version,
@@ -100,6 +103,9 @@ tasks.jar {
         for (tld in setOf("net", "com", "org")) {
             attributes("$tld/bukkit", "Sealed" to true)
         }
+        File("Sugarcane-Server/src/main/resources/branch-info.properties").bufferedWriter().use { out ->
+            out.write("branch=$gitBranch")
+        }
     }
 }
 
@@ -115,6 +121,7 @@ relocation {
     relocate("org.bukkit.craftbukkit" to "org.bukkit.craftbukkit.v$packageVersion") {
         exclude("org.bukkit.craftbukkit.Main*")
     }
+    relocate("de.tr7zw.changeme.nbtapi" to "de.tr7zw.nbtapi") // Sugarcane - Add NBT API as a first-class lib
 }
 
 tasks.shadowJar {
